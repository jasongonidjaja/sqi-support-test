{"ast":null,"code":"// import React, { useEffect, useState } from \"react\";\n// import api from \"../services/api\";\n// import {\n//   Box,\n//   Typography,\n//   CircularProgress,\n//   Paper,\n//   Dialog,\n//   DialogTitle,\n//   DialogContent,\n//   DialogActions,\n//   Button,\n//   MenuItem,\n//   Select,\n//   FormControl,\n//   InputLabel,\n// } from \"@mui/material\";\n// import DownloadIcon from \"@mui/icons-material/Download\";\n// import FullCalendar from \"@fullcalendar/react\";\n// import dayGridPlugin from \"@fullcalendar/daygrid\";\n\n// const DeploymentSupportCalendarPage = () => {\n//   const [deploymentSupports, setDeploymentSupports] = useState([]);\n//   const [loading, setLoading] = useState(true);\n//   const [selectedEvent, setSelectedEvent] = useState(null);\n//   const [openDialog, setOpenDialog] = useState(false);\n//   const [statuses] = useState([\"null\", \"Low\", \"Medium\", \"High\"]); // contoh status\n//   const [selectedStatus, setSelectedStatus] = useState(\"\");\n\n//   const role = \"SQI\"; // simulasi role\n\n//   const handleEventClick = (info) => {\n//     const { id, title, extendedProps } = info.event;\n//     setSelectedEvent({\n//       id,\n//       title,\n//       implementDate: extendedProps.implementDate,\n//       applicationName: extendedProps.applicationName,\n//       riskImpact: extendedProps.riskImpact,\n//       attachment: extendedProps.attachment,\n//       status: extendedProps.status || \"null\",\n//     });\n//     setSelectedStatus(extendedProps.status || \"null\");\n//     setOpenDialog(true);\n//   };\n\n//   const fetchDeploymentSupports = async () => {\n//     setLoading(true);\n//     try {\n//       const res = await api.get(\"/deployment-supports\", {\n//         params: {\n//           startDate: new Date().toISOString().split(\"T\")[0],\n//           endDate: new Date(new Date().setMonth(new Date().getMonth() + 1))\n//             .toISOString()\n//             .split(\"T\")[0],\n//         },\n//       });\n//       setDeploymentSupports(res.data?.data || res.data || []);\n//     } catch (err) {\n//       console.error(\"❌ Gagal mengambil data deployment supports:\", err);\n//       setDeploymentSupports([]);\n//     } finally {\n//       setLoading(false);\n//     }\n//   };\n\n//   useEffect(() => {\n//     fetchDeploymentSupports();\n//   }, []);\n\n//   const calendarEvents = (deploymentSupports || []).map((support) => ({\n//     id: support.id,\n//     title: `${support.title} - ${support.riskImpact}`,\n//     date: support.implementDate,\n//     implementDate: support.implementDate,\n//     applicationName: support.application || \"Unknown\",\n//     riskImpact: support.riskImpact,\n//     attachment: support.attachment,\n//     status: support.status,\n//     backgroundColor:\n//       support.riskImpact === \"Low\"\n//         ? \"#A5D6A7\"\n//         : support.riskImpact === \"Medium\"\n//         ? \"#FFF59D\"\n//         : support.riskImpact === \"High\"\n//         ? \"#EF9A9A\"\n//         : \"#E0E0E0\",\n//     textColor: \"#000000\",\n//   }));\n\n//   const handleDownload = async () => {\n//     try {\n//       if (!selectedEvent?.attachment) return;\n//       const filename = selectedEvent.attachment.split(\"/\").pop();\n//       const response = await api.get(`/deployment-supports/download/${filename}`, {\n//         responseType: \"blob\",\n//       });\n//       const url = window.URL.createObjectURL(new Blob([response.data]));\n//       const link = document.createElement(\"a\");\n//       link.href = url;\n//       link.setAttribute(\"download\", filename);\n//       document.body.appendChild(link);\n//       link.click();\n//       link.parentNode.removeChild(link);\n//     } catch (err) {\n//       console.error(\"❌ Gagal mengunduh file:\", err);\n//       alert(\"Gagal mengunduh file.\");\n//     }\n//   };\n\n//   const [isUpdating, setIsUpdating] = useState(false);\n\n//   const handleStatusChange = async (event) => {\n//     if (isUpdating) return;\n//     setIsUpdating(true);\n//     const newStatus = event.target.value;\n//     setSelectedStatus(newStatus);\n\n//     try {\n//       await api.patch(`/deployment-supports/${selectedEvent.id}`, {\n//         status: newStatus === \"null\" ? null : newStatus,\n//       });\n//       await fetchDeploymentSupports();\n//       setSelectedEvent((prev) => ({\n//         ...prev,\n//         status: newStatus === \"null\" ? null : newStatus,\n//       }));\n//       alert(\"Status berhasil diperbarui!\");\n//     } catch (err) {\n//       console.error(\"❌ Gagal memperbarui status:\", err);\n//       alert(\"Gagal memperbarui status.\");\n//     } finally {\n//       setIsUpdating(false);\n//     }\n//   };\n\n//   if (loading) {\n//     return (\n//       <Box\n//         sx={{\n//           display: \"flex\",\n//           justifyContent: \"center\",\n//           alignItems: \"center\",\n//           minHeight: \"100vh\",\n//           // marginLeft: \"220px\",\n//         }}\n//       >\n//         <CircularProgress size={50} />\n//       </Box>\n//     );\n//   }\n\n//   return (\n//     <Box sx={{ display: \"flex\" }}>\n//       <Box\n//         component=\"main\"\n//         sx={{\n//           flexGrow: 1,\n//           p: 3,\n//           // marginLeft: \"220px\",\n//           minHeight: \"100vh\",\n//           display: \"flex\",\n//           flexDirection: \"column\",\n//           alignItems: \"center\",\n//         }}\n//       >\n//         <Typography variant=\"h5\" fontWeight=\"bold\" sx={{ color: \"#1976d2\", mb: 3 }}>\n//           Kalender Deployment Support\n//         </Typography>\n\n//         <Paper elevation={3} sx={{ width: \"90%\", maxWidth: 900, p: 2, borderRadius: 2 }}>\n//           <FullCalendar\n//             plugins={[dayGridPlugin]}\n//             initialView=\"dayGridMonth\"\n//             height=\"80vh\"\n//             events={calendarEvents}\n//             eventDisplay=\"block\"\n//             eventClick={handleEventClick}\n//             eventDidMount={(info) => {\n//               info.el.style.padding = \"4px 6px\";\n//               info.el.style.borderRadius = \"4px\";\n//               info.el.style.fontWeight = \"600\";\n//               info.el.style.textAlign = \"center\";\n//             }}\n//           />\n\n//           <Dialog open={openDialog} onClose={() => setOpenDialog(false)} fullWidth>\n//             <DialogTitle>Detail Deployment Support</DialogTitle>\n//             <DialogContent dividers>\n//               {selectedEvent ? (\n//                 <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\n//                   <Typography>\n//                     <strong>Judul:</strong> {selectedEvent.title}\n//                   </Typography>\n//                   <Typography>\n//                     <strong>Aplikasi:</strong> {selectedEvent.applicationName}\n//                   </Typography>\n//                   <Typography>\n//                     <strong>Tanggal Implementasi:</strong> {selectedEvent.implementDate}\n//                   </Typography>\n//                   <Typography>\n//                     <strong>Risk Impact:</strong> {selectedEvent.riskImpact}\n//                   </Typography>\n//                 </Box>\n//               ) : (\n//                 <Typography>Tidak ada data.</Typography>\n//               )}\n//             </DialogContent>\n\n//             <DialogActions>\n//               {selectedEvent?.attachment && (\n//                 <Button\n//                   variant=\"outlined\"\n//                   color=\"primary\"\n//                   size=\"small\"\n//                   startIcon={<DownloadIcon />}\n//                   onClick={handleDownload}\n//                   sx={{ textTransform: \"none\", fontWeight: 500 }}\n//                 >\n//                   Download\n//                 </Button>\n//               )}\n\n//               {role === \"SQI\" && (\n//                 <FormControl size=\"small\" sx={{ minWidth: 120, mr: 2 }}>\n//                   <InputLabel id=\"status-label\">Status</InputLabel>\n//                   <Select\n//                     labelId=\"status-label\"\n//                     value={selectedStatus}\n//                     onChange={handleStatusChange}\n//                     label=\"Status\"\n//                   >\n//                     {statuses.map((status) => (\n//                       <MenuItem key={status} value={status}>\n//                         {status === \"null\" ? \"-\" : status}\n//                       </MenuItem>\n//                     ))}\n//                   </Select>\n//                 </FormControl>\n//               )}\n\n//               <Button onClick={() => setOpenDialog(false)} color=\"primary\">\n//                 Tutup\n//               </Button>\n//             </DialogActions>\n//           </Dialog>\n//         </Paper>\n//       </Box>\n//     </Box>\n//   );\n// };\n\n// export default DeploymentSupportCalendarPage;","map":{"version":3,"names":[],"sources":["C:/Users/jason/Desktop/Projects/sqi-support-app-cts-e/frontend/src/pages/DeploymentCalendarPage2.js"],"sourcesContent":["// import React, { useEffect, useState } from \"react\";\r\n// import api from \"../services/api\";\r\n// import {\r\n//   Box,\r\n//   Typography,\r\n//   CircularProgress,\r\n//   Paper,\r\n//   Dialog,\r\n//   DialogTitle,\r\n//   DialogContent,\r\n//   DialogActions,\r\n//   Button,\r\n//   MenuItem,\r\n//   Select,\r\n//   FormControl,\r\n//   InputLabel,\r\n// } from \"@mui/material\";\r\n// import DownloadIcon from \"@mui/icons-material/Download\";\r\n// import FullCalendar from \"@fullcalendar/react\";\r\n// import dayGridPlugin from \"@fullcalendar/daygrid\";\r\n\r\n// const DeploymentSupportCalendarPage = () => {\r\n//   const [deploymentSupports, setDeploymentSupports] = useState([]);\r\n//   const [loading, setLoading] = useState(true);\r\n//   const [selectedEvent, setSelectedEvent] = useState(null);\r\n//   const [openDialog, setOpenDialog] = useState(false);\r\n//   const [statuses] = useState([\"null\", \"Low\", \"Medium\", \"High\"]); // contoh status\r\n//   const [selectedStatus, setSelectedStatus] = useState(\"\");\r\n\r\n//   const role = \"SQI\"; // simulasi role\r\n\r\n//   const handleEventClick = (info) => {\r\n//     const { id, title, extendedProps } = info.event;\r\n//     setSelectedEvent({\r\n//       id,\r\n//       title,\r\n//       implementDate: extendedProps.implementDate,\r\n//       applicationName: extendedProps.applicationName,\r\n//       riskImpact: extendedProps.riskImpact,\r\n//       attachment: extendedProps.attachment,\r\n//       status: extendedProps.status || \"null\",\r\n//     });\r\n//     setSelectedStatus(extendedProps.status || \"null\");\r\n//     setOpenDialog(true);\r\n//   };\r\n\r\n//   const fetchDeploymentSupports = async () => {\r\n//     setLoading(true);\r\n//     try {\r\n//       const res = await api.get(\"/deployment-supports\", {\r\n//         params: {\r\n//           startDate: new Date().toISOString().split(\"T\")[0],\r\n//           endDate: new Date(new Date().setMonth(new Date().getMonth() + 1))\r\n//             .toISOString()\r\n//             .split(\"T\")[0],\r\n//         },\r\n//       });\r\n//       setDeploymentSupports(res.data?.data || res.data || []);\r\n//     } catch (err) {\r\n//       console.error(\"❌ Gagal mengambil data deployment supports:\", err);\r\n//       setDeploymentSupports([]);\r\n//     } finally {\r\n//       setLoading(false);\r\n//     }\r\n//   };\r\n\r\n//   useEffect(() => {\r\n//     fetchDeploymentSupports();\r\n//   }, []);\r\n\r\n//   const calendarEvents = (deploymentSupports || []).map((support) => ({\r\n//     id: support.id,\r\n//     title: `${support.title} - ${support.riskImpact}`,\r\n//     date: support.implementDate,\r\n//     implementDate: support.implementDate,\r\n//     applicationName: support.application || \"Unknown\",\r\n//     riskImpact: support.riskImpact,\r\n//     attachment: support.attachment,\r\n//     status: support.status,\r\n//     backgroundColor:\r\n//       support.riskImpact === \"Low\"\r\n//         ? \"#A5D6A7\"\r\n//         : support.riskImpact === \"Medium\"\r\n//         ? \"#FFF59D\"\r\n//         : support.riskImpact === \"High\"\r\n//         ? \"#EF9A9A\"\r\n//         : \"#E0E0E0\",\r\n//     textColor: \"#000000\",\r\n//   }));\r\n\r\n//   const handleDownload = async () => {\r\n//     try {\r\n//       if (!selectedEvent?.attachment) return;\r\n//       const filename = selectedEvent.attachment.split(\"/\").pop();\r\n//       const response = await api.get(`/deployment-supports/download/${filename}`, {\r\n//         responseType: \"blob\",\r\n//       });\r\n//       const url = window.URL.createObjectURL(new Blob([response.data]));\r\n//       const link = document.createElement(\"a\");\r\n//       link.href = url;\r\n//       link.setAttribute(\"download\", filename);\r\n//       document.body.appendChild(link);\r\n//       link.click();\r\n//       link.parentNode.removeChild(link);\r\n//     } catch (err) {\r\n//       console.error(\"❌ Gagal mengunduh file:\", err);\r\n//       alert(\"Gagal mengunduh file.\");\r\n//     }\r\n//   };\r\n\r\n//   const [isUpdating, setIsUpdating] = useState(false);\r\n\r\n//   const handleStatusChange = async (event) => {\r\n//     if (isUpdating) return;\r\n//     setIsUpdating(true);\r\n//     const newStatus = event.target.value;\r\n//     setSelectedStatus(newStatus);\r\n\r\n//     try {\r\n//       await api.patch(`/deployment-supports/${selectedEvent.id}`, {\r\n//         status: newStatus === \"null\" ? null : newStatus,\r\n//       });\r\n//       await fetchDeploymentSupports();\r\n//       setSelectedEvent((prev) => ({\r\n//         ...prev,\r\n//         status: newStatus === \"null\" ? null : newStatus,\r\n//       }));\r\n//       alert(\"Status berhasil diperbarui!\");\r\n//     } catch (err) {\r\n//       console.error(\"❌ Gagal memperbarui status:\", err);\r\n//       alert(\"Gagal memperbarui status.\");\r\n//     } finally {\r\n//       setIsUpdating(false);\r\n//     }\r\n//   };\r\n\r\n//   if (loading) {\r\n//     return (\r\n//       <Box\r\n//         sx={{\r\n//           display: \"flex\",\r\n//           justifyContent: \"center\",\r\n//           alignItems: \"center\",\r\n//           minHeight: \"100vh\",\r\n//           // marginLeft: \"220px\",\r\n//         }}\r\n//       >\r\n//         <CircularProgress size={50} />\r\n//       </Box>\r\n//     );\r\n//   }\r\n\r\n//   return (\r\n//     <Box sx={{ display: \"flex\" }}>\r\n//       <Box\r\n//         component=\"main\"\r\n//         sx={{\r\n//           flexGrow: 1,\r\n//           p: 3,\r\n//           // marginLeft: \"220px\",\r\n//           minHeight: \"100vh\",\r\n//           display: \"flex\",\r\n//           flexDirection: \"column\",\r\n//           alignItems: \"center\",\r\n//         }}\r\n//       >\r\n//         <Typography variant=\"h5\" fontWeight=\"bold\" sx={{ color: \"#1976d2\", mb: 3 }}>\r\n//           Kalender Deployment Support\r\n//         </Typography>\r\n\r\n//         <Paper elevation={3} sx={{ width: \"90%\", maxWidth: 900, p: 2, borderRadius: 2 }}>\r\n//           <FullCalendar\r\n//             plugins={[dayGridPlugin]}\r\n//             initialView=\"dayGridMonth\"\r\n//             height=\"80vh\"\r\n//             events={calendarEvents}\r\n//             eventDisplay=\"block\"\r\n//             eventClick={handleEventClick}\r\n//             eventDidMount={(info) => {\r\n//               info.el.style.padding = \"4px 6px\";\r\n//               info.el.style.borderRadius = \"4px\";\r\n//               info.el.style.fontWeight = \"600\";\r\n//               info.el.style.textAlign = \"center\";\r\n//             }}\r\n//           />\r\n\r\n//           <Dialog open={openDialog} onClose={() => setOpenDialog(false)} fullWidth>\r\n//             <DialogTitle>Detail Deployment Support</DialogTitle>\r\n//             <DialogContent dividers>\r\n//               {selectedEvent ? (\r\n//                 <Box sx={{ display: \"flex\", flexDirection: \"column\", gap: 1 }}>\r\n//                   <Typography>\r\n//                     <strong>Judul:</strong> {selectedEvent.title}\r\n//                   </Typography>\r\n//                   <Typography>\r\n//                     <strong>Aplikasi:</strong> {selectedEvent.applicationName}\r\n//                   </Typography>\r\n//                   <Typography>\r\n//                     <strong>Tanggal Implementasi:</strong> {selectedEvent.implementDate}\r\n//                   </Typography>\r\n//                   <Typography>\r\n//                     <strong>Risk Impact:</strong> {selectedEvent.riskImpact}\r\n//                   </Typography>\r\n//                 </Box>\r\n//               ) : (\r\n//                 <Typography>Tidak ada data.</Typography>\r\n//               )}\r\n//             </DialogContent>\r\n\r\n//             <DialogActions>\r\n//               {selectedEvent?.attachment && (\r\n//                 <Button\r\n//                   variant=\"outlined\"\r\n//                   color=\"primary\"\r\n//                   size=\"small\"\r\n//                   startIcon={<DownloadIcon />}\r\n//                   onClick={handleDownload}\r\n//                   sx={{ textTransform: \"none\", fontWeight: 500 }}\r\n//                 >\r\n//                   Download\r\n//                 </Button>\r\n//               )}\r\n\r\n//               {role === \"SQI\" && (\r\n//                 <FormControl size=\"small\" sx={{ minWidth: 120, mr: 2 }}>\r\n//                   <InputLabel id=\"status-label\">Status</InputLabel>\r\n//                   <Select\r\n//                     labelId=\"status-label\"\r\n//                     value={selectedStatus}\r\n//                     onChange={handleStatusChange}\r\n//                     label=\"Status\"\r\n//                   >\r\n//                     {statuses.map((status) => (\r\n//                       <MenuItem key={status} value={status}>\r\n//                         {status === \"null\" ? \"-\" : status}\r\n//                       </MenuItem>\r\n//                     ))}\r\n//                   </Select>\r\n//                 </FormControl>\r\n//               )}\r\n\r\n//               <Button onClick={() => setOpenDialog(false)} color=\"primary\">\r\n//                 Tutup\r\n//               </Button>\r\n//             </DialogActions>\r\n//           </Dialog>\r\n//         </Paper>\r\n//       </Box>\r\n//     </Box>\r\n//   );\r\n// };\r\n\r\n// export default DeploymentSupportCalendarPage;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}